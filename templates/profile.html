{% extends "base.html" %}
{% block content %}
<div class="discord-profile-modal" id="userProfileModal">
    <div class="profile-banner">
        <div class="profile-header">
            <div class="profile-avatar-container">
                <img src="{{ current_user.avatar or '/static/images/default-avatar.png' }}" alt="Profile Avatar" class="profile-avatar">
                <div class="presence-indicator {{ current_user.presence_state }}"></div>
            </div>
            <div class="profile-username-container">
                <h2 class="profile-username">{{ current_user.username }}</h2>
                {% if current_user.status %}
                <div class="profile-status">
                    {{ current_user.status }}
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="profile-content">
        <div class="profile-section">
            <h3>User Info</h3>
            <form method="POST" action="{{ url_for('update_status') }}" class="profile-form">
                <div class="form-group">
                    <label for="presence_state">Online Status</label>
                    <select id="presence_state" name="presence_state" class="form-control">
                        <option value="online" {% if current_user.presence_state == 'online' %}selected{% endif %}>Online</option>
                        <option value="idle" {% if current_user.presence_state == 'idle' %}selected{% endif %}>Idle</option>
                        <option value="dnd" {% if current_user.presence_state == 'dnd' %}selected{% endif %}>Do Not Disturb</option>
                        <option value="offline" {% if current_user.presence_state == 'offline' %}selected{% endif %}>Invisible</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="status">Custom Status</label>
                    <div class="status-input-group">
                        <div class="emoji-button" id="emojiButton">
                            <span id="selectedEmoji">{{ current_user.status_emoji or 'ğŸ˜Š' }}</span>
                        </div>
                        <input type="text" id="status" name="status" value="{{ current_user.status or '' }}" 
                               maxlength="128" placeholder="What's on your mind?" class="form-control">
                        <input type="hidden" id="statusEmoji" name="status_emoji" value="{{ current_user.status_emoji or '' }}">
                    </div>
                    <div id="emojiPicker" class="emoji-picker" style="display: none;">
                        <div class="emoji-list">
                            <span class="emoji-option" data-emoji="ğŸ˜Š">ğŸ˜Š</span>
                            <span class="emoji-option" data-emoji="ğŸ‘‹">ğŸ‘‹</span>
                            <span class="emoji-option" data-emoji="ğŸ’»">ğŸ’»</span>
                            <span class="emoji-option" data-emoji="ğŸ®">ğŸ®</span>
                            <span class="emoji-option" data-emoji="ğŸµ">ğŸµ</span>
                            <span class="emoji-option" data-emoji="ğŸ¨">ğŸ¨</span>
                            <span class="emoji-option" data-emoji="ğŸ“š">ğŸ“š</span>
                            <span class="emoji-option" data-emoji="âœ¨">âœ¨</span>
                            <span class="emoji-option" data-emoji="ğŸŒŸ">ğŸŒŸ</span>
                            <span class="emoji-option" data-emoji="ğŸ’­">ğŸ’­</span>
                        </div>
                    </div>
                </div>

                <div class="profile-info">
                    <p class="member-since">Member since {{ current_user.created_at.strftime('%B %d, %Y') }}</p>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </div>
            </form>

            <form method="POST" action="{{ url_for('update_avatar') }}" enctype="multipart/form-data" class="profile-form mt-4">
                <div class="form-group">
                    <label for="avatar">Change Avatar</label>
                    <input type="file" id="avatar" name="avatar" accept="image/*" class="form-control">
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Update Avatar</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}
